{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h3>🔍 Search Staff by Code</h3>

    <form method="post" class="form-inline mb-3">
        {% csrf_token %}
        <input type="text" name="staff_code" placeholder="Enter Staff Code" class="form-control" value="{{ staff_code }}" required>
        <button type="submit" class="btn btn-primary ml-2">Search</button>
    </form>

    {% if staff %}
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{ staff.name }}</h5>
                <p><strong>Email:</strong> {{ staff.email }}</p>
                <p><strong>Department:</strong> {{ staff.department }}</p>

                <hr>

                <!-- ✅ Work Assignment Form -->
                <h5 class="mt-3">Assign Task</h5>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <input type="hidden" name="assigned_to" value="{{ staff.id }}">
                    <button type="submit" class="btn btn-success">➕ Add Work Assignment</button>
                </form>
            </div>
        </div>
    {% elif staff_code %}
        <div class="alert alert-danger mt-3">⚠️ No staff found with code "{{ staff_code }}".</div>
    {% endif %}
</div>
{% endblock %}
